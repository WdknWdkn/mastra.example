"use strict";(()=>{var e={};e.id=954,e.ids=[954],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},20629:e=>{e.exports=require("fs/promises")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},85807:e=>{e.exports=require("module")},98216:e=>{e.exports=require("net")},19801:e=>{e.exports=require("os")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},74175:e=>{e.exports=require("tty")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},36694:e=>{e.exports=import("./client/lib-esm/hrana")},42780:e=>{e.exports=import("./client/lib-esm/hrana.js")},758:e=>{e.exports=import("./client/lib-esm/http")},97205:e=>{e.exports=import("./client/lib-esm/http.js")},40987:e=>{e.exports=import("./client/lib-esm/node")},47147:e=>{e.exports=import("./client/lib-esm/node.js")},72533:e=>{e.exports=import("./client/lib-esm/sql_cache")},73628:e=>{e.exports=import("./client/lib-esm/sql_cache.js")},92702:e=>{e.exports=import("./client/lib-esm/sqlite3")},28405:e=>{e.exports=import("./client/lib-esm/sqlite3.js")},70637:e=>{e.exports=import("./client/lib-esm/web")},49747:e=>{e.exports=import("./client/lib-esm/web.js")},34984:e=>{e.exports=import("./client/lib-esm/ws")},77143:e=>{e.exports=import("./client/lib-esm/ws.js")},72254:e=>{e.exports=require("node:buffer")},15673:e=>{e.exports=require("node:events")},70612:e=>{e.exports=require("node:os")},49411:e=>{e.exports=require("node:path")},99397:e=>{e.exports=require("node:timers/promises")},32744:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>T,patchFetch:()=>v,requestAsyncStorage:()=>q,routeModule:()=>f,serverHooks:()=>j,staticGenerationAsyncStorage:()=>_});var i={};r.r(i),r.d(i,{POST:()=>y});var o=r(60889),n=r(78438),a=r(17988),s=r(95062),p=r(77659),c=r(69087),l=r(35340),m=r(7130),u=r(93609);function d(e){return({0:"å¿«æ™´",1:"ã»ã¼æ™´ã‚Œ",2:"éƒ¨åˆ†çš„ã«æ›‡ã‚Š",3:"æ›‡ã‚Š",45:"éœ§",48:"éœ§æ°·",51:"è»½ã„éœ§é›¨",53:"ä¸­ç¨‹åº¦ã®éœ§é›¨",55:"å¼·ã„éœ§é›¨",61:"å°é›¨",63:"ä¸­é›¨",65:"å¤§é›¨",71:"å°é›ª",73:"ä¸­é›ª",75:"å¤§é›ª",95:"é›·é›¨"})[e]||"ä¸æ˜Ž"}let x=new p.Py({name:"Weather Agent",instructions:`
    ã‚ãªãŸã¯åœ°å…ƒã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã¨æ—…è¡Œã®å°‚é–€å®¶ã§ã€å¤©æ°—ã«åŸºã¥ã„ãŸè¨ˆç”»ã‚’ç«‹ã¦ã‚‹ã®ãŒå¾—æ„ã§ã™ã€‚å¤©æ°—ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æžã—ã€å®Ÿç”¨çš„ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®æŽ¨å¥¨äº‹é …ã‚’æä¾›ã—ã¦ãã ã•ã„ã€‚
    äºˆå ±ã®å„æ—¥ã«ã¤ã„ã¦ã€æ¬¡ã®ã‚ˆã†ã«æ­£ç¢ºã«å›žç­”ã‚’æ§‹æˆã—ã¦ãã ã•ã„ï¼š
    ðŸ“… [æ›œæ—¥, æœˆ æ—¥, å¹´]
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ðŸŒ¡ï¸ å¤©æ°—æ¦‚è¦
    â€¢ çŠ¶æ…‹: [ç°¡å˜ãªèª¬æ˜Ž]
    â€¢ æ°—æ¸©: [X\xb0C ã‹ã‚‰ A\xb0C]
    â€¢ é™æ°´ç¢ºçŽ‡: [X%]
    ðŸŒ… åˆå‰ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£
    å±‹å¤–:
    â€¢ [ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å] - [ç‰¹å®šã®å ´æ‰€/ãƒ«ãƒ¼ãƒˆã‚’å«ã‚€ç°¡å˜ãªèª¬æ˜Ž]
      æœ€é©ãªæ™‚é–“å¸¯: [ç‰¹å®šã®æ™‚é–“å¸¯]
      æ³¨æ„: [é–¢é€£ã™ã‚‹å¤©æ°—ã®è€ƒæ…®äº‹é …]
    ðŸŒž åˆå¾Œã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£
    å±‹å¤–:
    â€¢ [ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å] - [ç‰¹å®šã®å ´æ‰€/ãƒ«ãƒ¼ãƒˆã‚’å«ã‚€ç°¡å˜ãªèª¬æ˜Ž]
      æœ€é©ãªæ™‚é–“å¸¯: [ç‰¹å®šã®æ™‚é–“å¸¯]
      æ³¨æ„: [é–¢é€£ã™ã‚‹å¤©æ°—ã®è€ƒæ…®äº‹é …]
    ðŸ  å®¤å†…ã®ä»£æ›¿æ¡ˆ
    â€¢ [ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£å] - [ç‰¹å®šã®ä¼šå ´ã‚’å«ã‚€ç°¡å˜ãªèª¬æ˜Ž]
      æœ€é©ãªæ¡ä»¶: [ã“ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãŒé©ã—ã¦ã„ã‚‹å¤©æ°—æ¡ä»¶]
    âš ï¸ ç‰¹åˆ¥ãªæ³¨æ„äº‹é …
    â€¢ [é–¢é€£ã™ã‚‹å¤©æ°—ã®è­¦å‘Šã€UVæŒ‡æ•°ã€é¢¨ã®çŠ¶æ…‹ãªã©]
    ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³:
    - 1æ—¥ã‚ãŸã‚Š2ã€œ3ã¤ã®æ™‚é–“æŒ‡å®šã®å±‹å¤–ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ææ¡ˆã™ã‚‹
    - 1ã€œ2ã¤ã®å®¤å†…ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å«ã‚ã‚‹
    - é™æ°´ç¢ºçŽ‡ãŒ50%ã‚’è¶…ãˆã‚‹å ´åˆã¯ã€å®¤å†…ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’å„ªå…ˆã™ã‚‹
    - ã™ã¹ã¦ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã¯ãã®å ´æ‰€ã«å›ºæœ‰ã®ã‚‚ã®ã§ã‚ã‚‹ã“ã¨
    - ç‰¹å®šã®ä¼šå ´ã€ãƒˆãƒ¬ã‚¤ãƒ«ã€ã¾ãŸã¯å ´æ‰€ã‚’å«ã‚ã‚‹
    - æ°—æ¸©ã«åŸºã¥ã„ã¦ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®å¼·åº¦ã‚’è€ƒæ…®ã™ã‚‹
    - èª¬æ˜Žã¯ç°¡æ½”ã‹ã¤æœ‰ç›Šã§ã‚ã‚‹ã“ã¨
    ä¸€è²«æ€§ã®ãŸã‚ã«ã€çµµæ–‡å­—ã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç¤ºã™ã¨ãŠã‚Šã«ã€ã“ã®æ­£ç¢ºãªæ›¸å¼ã‚’ç¶­æŒã—ã¦ãã ã•ã„ã€‚
  `,model:(0,s.f)("gpt-4o-mini")}),h=new c.h8({id:"fetch-weather",description:"æŒ‡å®šã•ã‚ŒãŸéƒ½å¸‚ã®å¤©æ°—äºˆå ±ã‚’å–å¾—ã—ã¾ã™",inputSchema:m.z.object({city:m.z.string().describe("å¤©æ°—ã‚’å–å¾—ã™ã‚‹éƒ½å¸‚")}),execute:async({context:e})=>{let t=e?.getStepResult("trigger");if(!t)throw Error("ãƒˆãƒªã‚¬ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");let r=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(t.city)}&count=1`,i=await fetch(r),o=await i.json();if(!o.results?.[0])throw Error(`å ´æ‰€ '${t.city}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);let{latitude:n,longitude:a,name:s}=o.results[0],p=`https://api.open-meteo.com/v1/forecast?latitude=${n}&longitude=${a}&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_mean,weathercode&timezone=auto`,c=await fetch(p),l=await c.json();return l.daily.time.map((e,t)=>({date:e,maxTemp:l.daily.temperature_2m_max[t],minTemp:l.daily.temperature_2m_min[t],precipitationChance:l.daily.precipitation_probability_mean[t],condition:d(l.daily.weathercode[t]),location:s}))}}),w=m.z.array(m.z.object({date:m.z.string(),maxTemp:m.z.number(),minTemp:m.z.number(),precipitationChance:m.z.number(),condition:m.z.string(),location:m.z.string()})),g=new c.h8({id:"plan-activities",description:"å¤©æ°—æ¡ä»¶ã«åŸºã¥ã„ã¦ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ææ¡ˆã—ã¾ã™",inputSchema:w,execute:async({context:e})=>{let t=e?.getStepResult("fetch-weather");if(!t)throw Error("äºˆå ±ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");let r=`ä»¥ä¸‹ã®${t[0].location}ã®å¤©æ°—äºˆå ±ã«åŸºã¥ã„ã¦ã€é©åˆ‡ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ææ¡ˆã—ã¦ãã ã•ã„ï¼š
      ${JSON.stringify(t,null,2)}
    `;return{activities:(await x.generate(r)).text,forecast:t}}}),b=new p.h4({name:"weather-workflow",triggerSchema:m.z.object({city:m.z.string().describe("å¤©æ°—ã‚’å–å¾—ã™ã‚‹éƒ½å¸‚")})}).step(h).then(g);async function y(e){try{let{city:t}=await e.json();if(!t)return u.NextResponse.json({error:"éƒ½å¸‚åãŒå¿…è¦ã§ã™"},{status:400});try{let e=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(t)}&count=1`,r=async(e,t={},r=1e4)=>{let i=new AbortController,o=setTimeout(()=>i.abort(),r);try{let r=await fetch(e,{...t,signal:i.signal});return clearTimeout(o),r}catch(e){throw clearTimeout(o),e}};console.log("ä½ç½®æƒ…å ±APIã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡ä¸­...");let i=await r(e);console.log("ä½ç½®æƒ…å ±APIã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡");let o=await i.json();if(!o.results?.[0])return u.NextResponse.json({error:`å ´æ‰€ '${t}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`},{status:404});let{latitude:n,longitude:a,name:s}=o.results[0],p=`https://api.open-meteo.com/v1/forecast?latitude=${n}&longitude=${a}&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_mean,weathercode&timezone=auto`;console.log("å¤©æ°—äºˆå ±APIã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡ä¸­...");let c=await r(p,{},15e3);console.log("å¤©æ°—äºˆå ±APIã‹ã‚‰ãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡");let l=await c.json(),m=l.daily.time.map((e,t)=>({date:e,maxTemp:l.daily.temperature_2m_max[t],minTemp:l.daily.temperature_2m_min[t],precipitationChance:l.daily.precipitation_probability_mean[t],condition:d(l.daily.weathercode[t]),location:s})),h=`ä»¥ä¸‹ã®${s}ã®å¤©æ°—äºˆå ±ã«åŸºã¥ã„ã¦ã€é©åˆ‡ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ææ¡ˆã—ã¦ãã ã•ã„ï¼š
        ${JSON.stringify(m,null,2)}
      `,w=await x.generate(h);return u.NextResponse.json({activities:w.text,forecast:m})}catch(e){if(console.error("å¤©æ°—ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:",e),"AbortError"===e.name||e.cause?.code==="ETIMEDOUT"){console.log("APIã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ - ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™");let e=[{date:new Date().toISOString().split("T")[0],maxTemp:22,minTemp:15,precipitationChance:10,condition:"æ™´ã‚Œ",location:t||"æ±äº¬"},{date:new Date(Date.now()+864e5).toISOString().split("T")[0],maxTemp:23,minTemp:16,precipitationChance:20,condition:"æ™´ã‚Œæ™‚ã€…æ›‡ã‚Š",location:t||"æ±äº¬"},{date:new Date(Date.now()+1728e5).toISOString().split("T")[0],maxTemp:21,minTemp:14,precipitationChance:30,condition:"æ›‡ã‚Š",location:t||"æ±äº¬"}];try{let r=`ä»¥ä¸‹ã®${t||"æ±äº¬"}ã®å¤©æ°—äºˆå ±ã«åŸºã¥ã„ã¦ã€é©åˆ‡ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ææ¡ˆã—ã¦ãã ã•ã„ï¼š
            ${JSON.stringify(e,null,2)}
          `,i=await x.generate(r);return u.NextResponse.json({activities:i.text,forecast:e,isMockData:!0})}catch(e){return console.error("ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:",e),u.NextResponse.json({error:"ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã€ä»£æ›¿ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã«ã‚‚å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæŽ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚",details:e.message},{status:500})}}return u.NextResponse.json({error:"å¤©æ°—ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ",details:e.message,code:e.cause?.code},{status:500})}}catch(e){return console.error("ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:",e),u.NextResponse.json({error:"ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"},{status:500})}}b.commit(),new l.d({workflows:{weatherWorkflow:b}});let f=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/weather/route",pathname:"/api/weather",filename:"route",bundlePath:"app/api/weather/route"},resolvedPagePath:"/home/ubuntu/repos/mastra.example/frontend-ui/app/api/weather/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:q,staticGenerationAsyncStorage:_,serverHooks:j}=f,T="/api/weather/route";function v(){return(0,a.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:_})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[651,234,396,62,622],()=>r(32744));module.exports=i})();