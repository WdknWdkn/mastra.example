"use strict";(()=>{var e={};e.id=436,e.ids=[436],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},6311:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>D,requestAsyncStorage:()=>y,routeModule:()=>g,serverHooks:()=>K,staticGenerationAsyncStorage:()=>j});var n={};r.r(n),r.d(n,{POST:()=>x});var s=r(60889),a=r(78438),o=r(17988),i=r(93609),u=r(55315),c=r.n(u),l=r(92048),p=r.n(l);async function h(e){return{success:!0,response:`ご希望の条件をお聞かせください。${e}に関連する物件を探してみます。予算、エリア、間取りなどの条件をより詳しくお伝えいただければ、最適な物件をご提案いたします。`}}let m=c().join(process.cwd(),"..","attachments","6d3de071-7518-4fae-83f8-ead6ee9b3e7a","1.csv"),d=[];async function f(e=100){try{if(!p().existsSync(m))return console.error("CSVファイルが見つかりません:",m),[];let t=p().readFileSync(m,"utf8"),r=function(e,t={}){let r=e.split("\n"),n=t.limit||r.length;return r.slice(0,n).map(e=>{let t=[],r="",n=!1;for(let s=0;s<e.length;s++){let a=e[s];'"'===a?n=!n:","!==a||n?r+=a:(t.push(r),r="")}return t.push(r),t})}(t,{limit:e+1}),n=["物件ID","更新日","公開日","物件種別","賃貸区分","取引態様","物件番号","管理番号","物件画像URL","物件名称","物件名称カナ","価格タイプ","賃料・価格","管理費","号室","郵便番号","都道府県コード","所在地名称","所在地名称2","所在地名称3","緯度経度","最寄駅コード","最寄駅距離","駅1","駅2","駅3","間取り","間取り備考","建物面積・専有面積","土地面積","築年月","物件の特徴"];return r.slice(1,e+1).map(e=>{let t={};return n.forEach((r,n)=>{n<e.length&&(t[r]=e[n])}),t})}catch(e){return console.error("CSVファイル読み込み中にエラーが発生しました:",e),[]}}async function x(e){try{let t;let{message:r,isInitialLoad:n}=await e.json();if(n)try{return 0===d.length&&(d=await f(100)),i.NextResponse.json({success:!0,message:`物件データを読み込みました（${d.length}件）`,properties:d.slice(0,5)})}catch(e){return console.error("物件データ読み込み中にエラーが発生しました:",e),i.NextResponse.json({error:"物件データの読み込みに失敗しました"},{status:500})}if(!r)return i.NextResponse.json({error:"メッセージが提供されていません"},{status:400});0===d.length&&(d=await f(100));try{t=(await h(r)).response}catch(e){console.error("エージェント応答生成中にエラーが発生しました:",e),t=`ご希望の条件をお聞かせください。予算、エリア、間取りなどの条件をお伝えいただければ、最適な物件をご提案いたします。`}let s={},a=r.match(/(\d+)万円/);if(a){let e=1e4*parseInt(a[1]);s["賃料・価格"]={max:e}}let o=r.match(/(東京|横浜|大阪|名古屋|福岡|札幌|京都|神戸|さいたま|千葉|広島|仙台|川崎|北九州|堺)/g);o&&o.length>0&&(s["所在地名称"]=o[0]);let u=r.match(/(1LDK|2LDK|3LDK|4LDK|1K|1DK|2K|2DK|3K|3DK|4K|4DK)/i);u&&(s["間取り備考"]=u[0]);let c=function(e,t,r=5){try{if(!t||0===Object.keys(t).length)return e.slice(0,r);return e.filter(e=>Object.entries(t).every(([t,r])=>{if(r&&"object"==typeof r&&("min"in r||"max"in r)){let n=parseFloat(e[t]);return!isNaN(n)&&(!("min"in r)||!(n<r.min))&&(!("max"in r)||!(n>r.max))}return"string"==typeof r&&e[t]?e[t].includes(r):e[t]===r})).slice(0,r)}catch(e){return console.error("物件検索中にエラーが発生しました:",e),[]}}(d,s,5);return i.NextResponse.json({success:!0,response:t,properties:c,preferences:s})}catch(e){return console.error("リクエスト処理中にエラーが発生しました:",e),i.NextResponse.json({error:"リクエストの処理中にエラーが発生しました"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/real-estate/route",pathname:"/api/real-estate",filename:"route",bundlePath:"app/api/real-estate/route"},resolvedPagePath:"/home/ubuntu/repos/mastra.example/frontend-ui/app/api/real-estate/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:y,staticGenerationAsyncStorage:j,serverHooks:K}=g,v="/api/real-estate/route";function D(){return(0,o.patchFetch)({serverHooks:K,staticGenerationAsyncStorage:j})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[651,234],()=>r(6311));module.exports=n})();